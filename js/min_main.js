var link=document.querySelector(".link"),popup=document.querySelector(".letter"),successfully=document.querySelector(".successfully"),closeSuccessfully=successfully.querySelector(".close_button"),linkMap=document.querySelector(".little_map"),map=document.querySelector(".big_map"),isStorageSupport=!0,storage_1="",storage_2="",purchases=document.querySelectorAll(".buy");if(linkMap&&linkMap.addEventListener("click",function(e){e.preventDefault(),map.classList.add("modal_show")}),popup)var closePopup=popup.querySelector(".close_button"),form=popup.querySelector("form"),moniker=popup.querySelector("#lost_name"),email=popup.querySelector("#lost_email"),text=popup.querySelector("#lost_text");if(map)var closeMap=map.querySelector(".close_button");try{storage_1=localStorage.getItem("moniker"),storage_2=localStorage.getItem("email")}catch(e){isStorageSupport=!1}for(var addThumbnailClickHandler=function(e){e.addEventListener("click",function(e){e.preventDefault(),successfully.classList.add("modal_show")})},i=0;i<purchases.length;i++)addThumbnailClickHandler(purchases[i]);closeMap&&closeMap.addEventListener("click",function(){map.classList.remove("modal_show")}),link&&link.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("modal_show"),storage_1?(moniker.value=storage_1,email.focus()):moniker.focus(),storage_2&&(email.value=storage_2),storage_1&&storage_2&&text.focus()}),closePopup&&closePopup.addEventListener("click",function(){popup.classList.remove("modal_show"),popup.classList.remove("modal_error")}),closeSuccessfully&&closeSuccessfully.addEventListener("click",function(){successfully.classList.remove("modal_show")}),form&&form.addEventListener("submit",function(e){moniker.value&&email.value?isStorageSupport&&(localStorage.setItem("moniker",moniker.value),localStorage.setItem("email",email.value)):(e.preventDefault(),popup.classList.remove("modal_error"),popup.offsetWidth=popup.offsetWidth,popup.classList.add("modal_error"))}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),successfully.classList.contains("modal_show")?successfully.classList.remove("modal_show"):popup&&(popup.classList.contains("modal_show")?(popup.classList.remove("modal_show"),popup.classList.remove("modal_error")):map.classList.contains("modal_show")&&map.classList.remove("modal_show")))});
